# NextJS

## Routing

NextJSçš„è·¯ç”±ç³»ç»ŸåŸºäºæ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ç»“æ„ç›´æ¥å†³å®šäº†åº”ç”¨è·¯ç”±ã€‚

### åŸºç¡€é¡µé¢è·¯ç”±

ğŸ“ `app`

- ğŸ“„ `page.tsx` â†’ `/`ï¼ˆé¦–é¡µï¼‰
- ğŸ“ `about`
  - ğŸ“„ `page.tsx` â†’ `/about`ï¼ˆå…³äºé¡µé¢ï¼‰
- ğŸ“ `blog`
  - ğŸ“„ `page.tsx` â†’ `/blog`ï¼ˆåšå®¢é¦–é¡µï¼‰
  - ğŸ“ `[id]`
    - ğŸ“„ `page.tsx` â†’ `/blog/:id`ï¼ˆåŠ¨æ€è·¯ç”±ï¼‰

### åŠ¨æ€è·¯ç”±

å¦‚æœéœ€è¦åˆ›å»ºåŠ¨æ€è·¯å¾„ï¼Œæ¯”å¦‚/blog/123ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·å®šä¹‰åŠ¨æ€è·¯ç”±ï¼š

```js
app/
  blog/
    [id]/
      page.tsx  # å¯¹åº” /blog/:id
```

ç¤ºä¾‹ä»£ç ï¼ˆapp/blog/[id]/page.tsx),å½“è®¿é—®/blog/123æ—¶ï¼Œparams.idä¼šè‡ªåŠ¨è§£æä¸º123.

```js
export default function BlogPost({params}:{params:{id:string}}){
    return <h1>Bolg Post Id:{params.id}</h1>
}
```

### å¯é€‰çš„åŠ¨æ€è·¯ç”±

å¦‚æœæŸä¸ªåŠ¨æ€å‚æ•°æ—¶å¯é€‰çš„ï¼Œå¯ä»¥ä½¿ç”¨åŒæ–¹æ‹¬å·

```js
app/
  blog/
    [[id]]/
      page.tsx  # å¯¹åº” /blog æˆ– /blog/:id
```

### åµŒå¥—è·¯ç”±&Layouts

```js
app/
  layout.tsx  # å…¨å±€å¸ƒå±€
  page.tsx  # é¦–é¡µ
  dashboard/
    layout.tsx  # dashboard ä¸“å±å¸ƒå±€
    page.tsx  # /dashboard
    settings/
      page.tsx  # /dashboard/settings
```

ç¤ºä¾‹ä»£ç (app/dashboard/layout.tsx)

```js
export default function DashboardLayout({ children }: { children: React.ReactNode }) {
  return (
    <div>
      <nav>Dashboard Navigation</nav>
      <main>{children}</main>
    </div>
  );
}
```

### APIè·¯ç”±

NextJSå…è®¸åœ¨app/apiç›®å½•ä¸‹å®šä¹‰APIè·¯ç”±ï¼š

ğŸ“ `app/api`

- ğŸ“ `hello`
  - ğŸ“„ `route.ts` â†’ `GET /api/hello`

ç¤ºä¾‹ä»£ç (app/api/hello/route.ts)

```js
export async function GET() {
  return Response.json({ message: "Hello, Next.js!" });
}
```

è®¿é—®/api/helloæ—¶ï¼Œæµè§ˆå™¨ä¼šæ”¶åˆ°{"message":"Hello,Next.js!"}

### é¡µé¢é‡å®šå‘å’Œè‡ªå®šä¹‰404

NextJSå…è®¸ä½ åœ¨not-found.tsxæ–‡ä»¶ä¸­å®šä¹‰è‡ªå®šä¹‰404é¡µé¢ï¼š

ç¤ºä¾‹ä»£ç :

```js
export default function NotFound() {
  return <h1>Page Not Found</h1>;
}
```

ä¹Ÿå¯ä»¥ä½¿ç”¨redirect()è¿›è¡Œé¡µé¢é‡å®šå‘ï¼š

```js
import { redirect } from "next/navigation";

export default function Page() {
  redirect("/dashboard");
}
```

## Catch All Segments(æ•è·æ‰€æœ‰è·¯ç”±æ®µ)

åœ¨NextJSä¸­ï¼ŒCatch-All Segmentså…è®¸ä½ åŒ¹é…å¤šä¸ªURLæ®µï¼Œå¹¶åœ¨ç»„ä»¶ä¸­è·å–ä»–ä»¬çš„å‚æ•°ã€‚è¿™ç§è·¯ç”±æ¨¡å¼é€‚ç”¨äºä½ç½®æ•°é‡çš„åŠ¨æ€è·¯ç”±ï¼Œæ¯”å¦‚åšå®¢åˆ†ç±»ï¼Œæ–‡ä»¶ç³»ç»Ÿè·¯å¾„ç­‰

### åŸºæœ¬ç”¨æ³•

å¯ä»¥ä½¿ç”¨[...slug]æ¥åˆ›å»ºä¸€ä¸ªæ•è·æ‰€æœ‰è·¯ç”±æ®µçš„åŠ¨æ€è·¯å¾„

ğŸ“ `app/blog`

- ğŸ“„ `page.tsx` â†’ `/blog`ï¼ˆåšå®¢é¦–é¡µï¼‰
- ğŸ“ `[...slug]`
  - ğŸ“„ `page.tsx` â†’ `/blog/*`ï¼ˆæ•è·æ‰€æœ‰è·¯å¾„ï¼‰

ç¤ºä¾‹ä»£ç (app/blog/[...slug]/page.tsx)

```js
export default function Blog({ params }: { params: { slug?: string[] } }) {
  return <h1>Blog Path: {params.slug ? params.slug.join(" / ") : "Home"}</h1>;
}
```

### å¯é€‰çš„Catch-Allè·¯ç”±

å¦‚æœä½ å¸Œæœ›/blogä¹ŸåŒ¹é…app/blog/[...slug]/page.tsx,ä½†params.slugä¾ç„¶èƒ½ä¸ºundefinedï¼Œå¯ä»¥ä½¿ç”¨å¯é€‰Catch-Allè·¯ç”±"[[...sulg]]"

ğŸ“ `app/blog`

- ğŸ“ `[[...slug]]`
  - ğŸ“„ `page.tsx` â†’ `/blog/*`ï¼ˆåŒ…å« `/blog`ï¼‰

ç¤ºä¾‹ä»£ç  app/blog/[[...slug]]/page.tsx

```js
export default function Blog({ params }: { params: { slug?: string[] } }) {
  return <h1>Blog Path: {params.slug ? params.slug.join(" / ") : "Home"}</h1>;
}
```

### ç»“åˆAPIè·¯ç”±



## Intercepting Routes

(.)æ˜¯åŒ¹é…åŒä¸€å±‚çº§çš„

(..)æ˜¯åŒ¹é…ä¸Šä¸€å±‚çº§çš„

(..)(..)æ˜¯åŒ¹é…ä¸¤ä¸ªå±‚çº§ä»¥ä¸Šçš„

(...)æ˜¯åŒ¹é…appæ ¹ç›®å½•ä¸‹çš„

## Client-Side Rendering(å®¢æˆ·ç«¯æ¸²æŸ“)

æŒ‡çš„æ˜¯ç½‘é¡µçš„å†…å®¹ä¸»è¦ç”±æµè§ˆå™¨åœ¨ç”¨æˆ·ç«¯åŠ¨æ€æ¸²æŸ“ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ç«¯ç›´æ¥è¿”å›å®Œæ•´çš„htmlé¡µé¢ã€‚

ä¾èµ–äºJavaScriptï¼Œä¸»è¦é€‚ç”¨äº**å•é¡µé¢**åº”ç”¨ã€‚

ä¼˜ç¼ºç‚¹ï¼š

ä¼˜ç‚¹ï¼šæ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé¡µé¢åˆ‡æ¢æ›´æµç¨‹ï¼Œæ— éœ€é¢‘ç¹çš„è¯·æ±‚æœåŠ¡å™¨ã€‚(é€‚ç”¨äºäº¤äº’æ€§å¼ºçš„åº”ç”¨ï¼Œæ¯”å¦‚ç®¡ç†åå°ï¼Œåœ¨çº¿ç¼–è¾‘ç­‰)

ç¼ºç‚¹ï¼šæœç´¢å¼•æ“ä¼˜åŒ–ä¸å‹å¥½ï¼Œæœç´¢å¼•æ“å¯èƒ½æ— æ³•æ­£ç¡®è§£æJSåŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼›

é¦–æ¬¡åŠ è½½çš„é€Ÿåº¦æ…¢ï¼Œä¸é€‚åˆä½ç«¯è®¾å¤‡ã€‚

## Server-Side Rendering

æœåŠ¡å™¨åœ¨æ¥å—åˆ°ç”¨æˆ·çš„è¯·æ±‚åï¼Œåœ¨æœåŠ¡ç«¯æ‰§è¡ŒJavaScriptå¹¶ç”Ÿæˆå®Œæ•´çš„htmlé¡µé¢ï¼Œç„¶åè¿”å›ç»™æµè§ˆå™¨ã€‚

ä¼˜ç¼ºç‚¹ï¼š
ä¼˜ç‚¹ï¼šSEOï¼ˆæœç´¢å¼•æ“ä¼˜åŒ–ï¼‰å‹å¥½ï¼Œé¦–å±åŠ è½½æ›´å¿«ï¼Œé€‚åˆåŠ¨æ€å†…å®¹ã€‚

ç¼ºç‚¹ï¼šæœåŠ¡å™¨å‹åŠ›å¤§ï¼Œé¡µé¢äº¤äº’ä¾èµ–é¢å¤–çš„JavaScripts

## Suspense for SSR

Streaming Rendering(æµå¼æ¸²æŸ“)ï¼šæœåŠ¡å™¨ç«¯å¯ä»¥å…ˆå‘é€é™æ€htmlï¼Œç„¶åå¼‚æ­¥åŠ è½½Suspenseç»„ä»¶ï¼Œç­‰æ•°æ®å‡†å¤‡å¥½åå†æ¸²æŸ“å‰©ä½™éƒ¨åˆ†ã€‚

éƒ¨åˆ†Hydration(éƒ¨åˆ†æ°´åˆ)ï¼šå…è®¸æœåŠ¡å™¨å…ˆæ¸²æŸ“ä¸€éƒ¨åˆ†UIï¼Œç­‰å®¢æˆ·ç«¯JavaScriptåŠ è½½åï¼Œé€æ­¥è®©ç»„ä»¶å¯äº¤äº’ã€‚

## React Server Components(RSC)

å®ƒå…è®¸éƒ¨åˆ†Reactç»„ä»¶åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œç„¶åæŠŠç»“æœå‘é€åˆ°å®¢æˆ·ç«¯è¿›è¡Œæ¸²æŸ“ï¼Œå‡å°‘JavaScriptè´Ÿæ‹…ï¼Œæé«˜é¡µé¢æ€§èƒ½ã€‚

åœ¨ä¼ ç»Ÿçš„Reactåº”ç”¨ä¸­ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½ä¼šè¢«æ‰“åŒ…åˆ°JavaScriptæ–‡ä»¶å¹¶ä¸‹è½½åˆ°å®¢æˆ·ç«¯ï¼Œç„¶åæµè§ˆå™¨æ‰§è¡Œä»–ä»¬ã€‚ï¼ˆè¿™æ ·ä¼šå¯¼è‡´JSä½“ç§¯è¿‡å¤§ï¼ŒåŠ è½½æ…¢ï¼Œæ¸²æŸ“æ€§èƒ½ä¸‹é™ï¼‰ï¼Œä½†åœ¨RSCä¸­ï¼Œç»„ä»¶å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œå®¢æˆ·ç«¯åªæ¥å—æœ€ç»ˆhtmlå’Œæ•°æ®ï¼Œä¸éœ€è¦ä¸‹è½½ç»„ä»¶çš„JavaScriptä»£ç ã€‚

## Static Rendering(é™æ€æ¸²æŸ“)

å®ƒæ˜¯Next.jsæä¾›çš„ä¸€ç§é¢„æ¸²æŸ“æ–¹å¼ï¼Œä»–ä¼šåœ¨æ„å»ºæ—¶ç”Ÿæˆhtmlé¡µé¢ï¼Œå¹¶åœ¨è¯·æ±‚æ—¶ç›´æ¥è¿”å›é™æ€htmlï¼Œæé«˜åŠ è½½é€Ÿåº¦å’ŒSEOå‹å¥½æ€§ã€‚

## Dynamic Rendering(åŠ¨æ€æ¸²æŸ“)

å®ƒæ˜¯åœ¨Next.jsä¸­æŒ‡çš„æ˜¯é¡µé¢åœ¨è¯·æ±‚æ—¶åŠ¨æ€ç”Ÿæˆhtmlï¼Œé€‚ç”¨äºéœ€è¦ä¸ªæ€§åŒ–ï¼Œå®æ—¶æ›´æ–°æˆ–è€…æ•°æ®åº“æŸ¥è¯¢çš„é¡µé¢ã€‚

ä¸¤ç§æ–¹å¼ï¼š

Server-Side Rendering(SSR):æ¯æ¬¡è¯·æ±‚ç”Ÿæˆæ–°çš„htmlï¼Œé€‚ç”¨äºå®æ—¶æ•°æ®ã€‚

On-Demand ISR(å¢é‡é™æ€å†ç”Ÿ) é™æ€é¡µé¢æŒ‰éœ€æ›´æ–°ï¼Œé€‚ç”¨äºéƒ¨åˆ†åŠ¨æ€æ•°æ®ã€‚

## Streamingï¼ˆæµå¼æ¸²æŸ“ï¼‰

å®ƒæ˜¯Next.jsçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå…è®¸æœåŠ¡å™¨é€æ­¥å‘é€htmlåˆ°äº†å®¢æˆ·ç«¯ï¼Œè€Œä¸æ˜¯ç­‰æ‰€æœ‰æ•°æ®å‡†å¤‡å¥½å†ä¸€æ¬¡æ€§è¿”å›æ•´ä¸ªé¡µé¢ã€‚è¿™æ ·å¯ä»¥å¤§å¹…åº¦æé«˜é¦–å±çš„åŠ è½½é€Ÿåº¦ï¼Œå°¤å…¶å®åœ¨éœ€è¦æ…¢é€ŸAPIè¯·æ±‚ï¼Œæ•°æ®åº“æŸ¥è¯¢çš„é¡µé¢ã€‚

## Interleaving Server and Client Components(äº¤é”™ä½¿ç”¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ç»„ä»¶)

Server Componentsé‡Œå¯ä»¥åµŒå¥—Client Components

Client Componentsé‡Œé¢ä¹Ÿå¯ä»¥importå…¶ä»–çš„Client Compinents

ä½†Client Componentsé‡Œé¢ä¸èƒ½import Server Components

## Data Cache(æ•°æ®ç¼“å­˜)

ä¸€èˆ¬æ¥è¯´å¦‚æœä½¿ç”¨fetchä»apiè·å–æ•°æ®ï¼ŒNextJsä¼šç¼“å­˜è¿™ä¸ªfetchè¯·æ±‚ï¼ˆè¿™æ ·å¤šä¸ªç”¨æˆ·è®¿é—®æ—¶å°±ä¸ä¼šé‡å¤è¯·æ±‚apiï¼‰ã€‚ä½†æœ‰ä¸€ä¸ªé—®é¢˜---å¦‚æœapiæ•°æ®æ›´æ–°äº†ï¼Œé¡µé¢ä¸ä¼šè‡ªåŠ¨åˆ·æ–°(é™¤éä½ å¼ºåˆ¶è®©ä»–é‡æ–°éªŒè¯æ•°æ®)

å¢é‡å†ç”Ÿï¼ˆISR) :ä½¿ç”¨next:{revalidate:ç§’æ•°}æ•°æ®æ¯ä¸ªXç§’æ›´æ–°ä¸€æ¬¡

## Request Memoization(è¯·æ±‚è®°å¿†åŒ–)

å…è®¸NextJsé¿å…é‡å¤APIè¯·æ±‚æˆ–æ•°æ®åº“æŸ¥è¯¢ï¼Œä»è€Œæé«˜æ€§èƒ½ï¼Œå‡å°‘æœåŠ¡å™¨è´Ÿæ‹…ï¼Œç¡®ä¿æ•°æ®åªè¢«è¯·æ±‚ä¸€æ¬¡ã€‚

ç®€å•æ¥è¯´å°±æ˜¯ï¼šå¦‚æœå¤šä¸ªç»„ä»¶æˆ–è¯·æ±‚ä½¿ç”¨ç›¸åŒçš„æ•°æ®ï¼ŒMemorizationè®©å®ƒä»¬å…±ç”¨ä¸€ä¸ªè¯·æ±‚ç»“æœï¼Œè€Œä¸æ˜¯å¤šæ¬¡è¯·æ±‚apiã€‚
